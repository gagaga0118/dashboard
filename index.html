<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>能源系统效率分析看板</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        :root {
            --primary: #1a2a3a;
            --secondary: #2c3e50;
            --accent: #1abc9c;
            --efficiency: #3498db;
            --warning: #e74c3c;
            --light: #ecf0f1;
            --dark: #1a1f29;
            --card-bg: rgba(255, 255, 255, 0.08);
            --card-border: rgba(255, 255, 255, 0.12);
        }
        
        body {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--light);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }
        
        .header {
            text-align: center;
            padding: 30px 0;
            margin-bottom: 20px;
            position: relative;
            animation: fadeIn 1.2s ease-out;
        }
        
        .header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 4px;
            background: linear-gradient(90deg, transparent, var(--accent), transparent);
            border-radius: 2px;
        }
        
        .header h1 {
            font-size: 3rem;
            margin-bottom: 15px;
            background: linear-gradient(to right, #4ecdc4, #43cea2);
            /* 添加 -webkit- 前缀解决兼容性问题 */
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 2px 10px rgba(0,0,0,0.2);
            letter-spacing: 1px;
        }
        
        .header .subtitle {
            font-size: 1.3rem;
            color: var(--light);
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
            opacity: 0.85;
            font-weight: 300;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--card-border);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            animation: slideUp 0.8s ease-out;
            animation-fill-mode: backwards;
        }
        
        .card:nth-child(1) { animation-delay: 0.2s; }
        .card:nth-child(2) { animation-delay: 0.3s; }
        .card:nth-child(3) { animation-delay: 0.4s; }
        .card:nth-child(4) { animation-delay: 0.5s; }
        
        .card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 45px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(26, 188, 156, 0.3);
        }
        
        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            color: var(--accent);
        }
        
        .card-header i {
            font-size: 24px;
            margin-right: 15px;
            background: rgba(26, 188, 156, 0.15);
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
        }
        
        .card-title {
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .card-value {
            font-size: 2.8rem;
            font-weight: 700;
            margin: 10px 0;
            text-align: center;
            font-family: 'Courier New', monospace;
            background: linear-gradient(to bottom, #fff, #c3e6ff);
            /* 添加 -webkit- 前缀解决兼容性问题 */
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .card-value span {
            font-size: 1.2rem;
            color: var(--accent);
        }
        
        .card-footer {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            font-size: 0.95rem;
            color: rgba(255, 255, 255, 0.7);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 15px;
        }
        
        .chart-container {
            grid-column: 1 / -1;
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--card-border);
            height: 500px;
            margin-bottom: 30px;
            animation: fadeIn 1s ease-out;
            animation-delay: 0.6s;
            animation-fill-mode: backwards;
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .chart-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--accent);
            display: flex;
            align-items: center;
        }
        
        .chart-title i {
            margin-right: 12px;
        }
        
        .chart-controls {
            display: flex;
            gap: 10px;
        }
        
        .time-btn {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.8);
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }
        
        .time-btn.active {
            background: var(--accent);
            color: white;
        }
        
        .time-btn:hover:not(.active) {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .info-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .info-card {
            padding: 25px;
            border-radius: 15px;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            animation: slideUp 0.8s ease-out;
            animation-fill-mode: backwards;
        }
        
        .info-card:nth-child(1) { animation-delay: 0.7s; }
        .info-card:nth-child(2) { animation-delay: 0.8s; }
        .info-card:nth-child(3) { animation-delay: 0.9s; }
        
        .info-title {
            color: var(--accent);
            margin-bottom: 20px;
            font-size: 1.4rem;
            display: flex;
            align-items: center;
        }
        
        .info-title i {
            margin-right: 10px;
            background: rgba(26, 188, 156, 0.15);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
        }
        
        .info-content {
            line-height: 1.8;
            color: rgba(255, 255, 255, 0.85);
        }
        
        .info-content p {
            margin-bottom: 15px;
            display: flex;
            align-items: flex-start;
        }
        
        .info-content p i {
            margin-right: 10px;
            color: var(--accent);
            margin-top: 5px;
        }
        
        .efficiency-bar {
            height: 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .efficiency-fill {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #1abc9c);
            border-radius: 6px;
            width: 78.3%; /* Dynamic in real app */
            position: relative;
            overflow: hidden;
        }
        
        .efficiency-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.3), 
                transparent);
            animation: shine 2s infinite;
        }
        
        .update-info {
            text-align: center;
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.95rem;
            margin-top: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.15);
            border-radius: 10px;
            animation: fadeIn 1.2s ease-out;
        }
        
        .deployment-info {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 10px;
            font-size: 0.9rem;
        }
        
        .deployment-info span {
            display: flex;
            align-items: center;
        }
        
        .deployment-info i {
            margin-right: 8px;
            color: var(--accent);
        }
        
        .status-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-left: 10px;
        }
        
        .status-operational {
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
        }
        
        .optimization {
            color: var(--accent);
            font-weight: 600;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideUp {
            from { 
                opacity: 0; 
                transform: translateY(30px);
            }
            to { 
                opacity: 1; 
                transform: translateY(0);
            }
        }
        
        @keyframes shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2.4rem;
            }
            
            .header .subtitle {
                font-size: 1.1rem;
            }
            
            .chart-container {
                height: 400px;
            }
            
            .chart-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>能源系统效率分析看板</h1>
        <p class="subtitle">实时分析气象条件对能源系统运行效率的影响，结合热力学模型进行系统效率优化分析</p>
    </div>
    
    <div class="dashboard">
        <div class="card">
            <div class="card-header">
                <i class="fas fa-thermometer-half"></i>
                <div class="card-title">环境温度</div>
            </div>
            <div class="card-value">26.4<span>°C</span></div>
            <div class="card-footer">
                <div>较昨日: <span class="optimization">+2.1°C</span></div>
                <div>理想范围: 18-24°C</div>
            </div>
        </div>
        
        <div class="card">
            <div class="card-header">
                <i class="fas fa-tint"></i>
                <div class="card-title">相对湿度</div>
            </div>
            <div class="card-value">65<span>%</span></div>
            <div class="card-footer">
                <div>较昨日: <span class="optimization">-8%</span></div>
                <div>理想范围: 40-70%</div>
            </div>
        </div>
        
        <div class="card">
            <div class="card-header">
                <i class="fas fa-wind"></i>
                <div class="card-title">风速</div>
            </div>
            <div class="card-value">3.2<span>m/s</span></div>
            <div class="card-footer">
                <div>较昨日: <span class="optimization">+1.1m/s</span></div>
                <div>理想范围: 2-5m/s</div>
            </div>
        </div>
        
        <div class="card">
            <div class="card-header">
                <i class="fas fa-bolt"></i>
                <div class="card-title">系统效率</div>
            </div>
            <div class="card-value">78.3<span>%</span></div>
            <div class="efficiency-bar">
                <div class="efficiency-fill" style="width: 78.3%"></div>
            </div>
            <div class="card-footer">
                <div>理论最高: 92.5%</div>
                <div>优化潜力: <span class="optimization">14.2%</span></div>
            </div>
        </div>
    </div>
    
    <div class="chart-container">
        <div class="chart-header">
            <div class="chart-title">
                <i class="fas fa-chart-line"></i> 气象与系统效率趋势分析
            </div>
            <div class="chart-controls">
                <button class="time-btn active">24小时</button>
                <button class="time-btn">7天</button>
                <button class="time-btn">30天</button>
            </div>
        </div>
        <canvas id="efficiency-chart"></canvas>
    </div>
    
    <div class="info-section">
        <div class="info-card">
            <div class="info-title">
                <i class="fas fa-info-circle"></i> 系统运行状态
            </div>
            <div class="info-content">
                <p><i class="fas fa-check-circle"></i> 当前系统状态: <span class="status-badge status-operational">运行正常</span></p>
                <p><i class="fas fa-microchip"></i> 系统负载: 845 kW (设计容量: 1200 kW)</p>
                <p><i class="fas fa-water"></i> 冷却水温度: 32.5°C (目标: 28-30°C)</p>
                <p><i class="fas fa-tachometer-alt"></i> 蒸汽压力: 2.45 MPa (正常范围: 2.3-2.6 MPa)</p>
                <p><i class="fas fa-gas-pump"></i> 燃料消耗率: 185 kg/s (基准: 175 kg/s)</p>
            </div>
        </div>
        
        <div class="info-card">
            <div class="info-title">
                <i class="fas fa-cloud-sun"></i> 气象影响分析
            </div>
            <div class="info-content">
                <p><i class="fas fa-temperature-high"></i> 当前温度高于理想范围，导致冷却效率下降约 8.2%</p>
                <p><i class="fas fa-smog"></i> 湿度处于理想范围，有利于系统稳定运行</p>
                <p><i class="fas fa-wind"></i> 风速增加有助于散热，部分抵消高温影响</p>
                <p><i class="fas fa-chart-line"></i> 根据预测，明日温度下降后效率可提升至 83%</p>
                <p><i class="fas fa-lightbulb"></i> 建议: 增加冷却塔风扇转速，优化热交换效率</p>
            </div>
        </div>
        
        <div class="info-card">
            <div class="info-title">
                <i class="fas fa-cogs"></i> 热力学模型
            </div>
            <div class="info-content">
                <p><i class="fas fa-project-diagram"></i> 基于卡诺循环与朗肯循环改进</p>
                <p><i class="fas fa-sign-in-alt"></i> 输入参数: 温度, 湿度, 气压, 风速</p>
                <p><i class="fas fa-sign-out-alt"></i> 输出参数: 理论效率, 最优负载, 热损失</p>
                <p><i class="fas fa-calculator"></i> 实时计算理论最优值与实际值差距</p>
                <p><i class="fas fa-function"></i> 公式: η = 1 - (T_cold / T_hot) × f(humidity, pressure)</p>
            </div>
        </div>
    </div>
    
    <div class="update-info">
        <p>数据最后更新: <span id="update-time">2023年10月15日 14:28:35</span></p>
        <div class="deployment-info">
            <span><i class="fas fa-bolt"></i> Cloudflare Pages</span>
            <span><i class="fas fa-cloud"></i> OpenWeatherMap API</span>
            <span><i class="fas fa-server"></i> 系统传感器网络</span>
        </div>
    </div>

    <script>
        // 模拟气象和能源数据
        function generateData() {
            const now = new Date();
            const labels = [];
            const tempData = [];
            const humidityData = [];
            const windData = [];
            const idealLoad = [];
            const actualLoad = [];
            const efficiency = [];
            
            // 生成过去24小时的数据
            for (let i = 23; i >= 0; i--) {
                const time = new Date(now);
                time.setHours(now.getHours() - i);
                const hour = time.getHours();
                labels.push(`${hour}:00`);
                
                // 温度数据 (20-32之间波动)
                const baseTemp = 22 + Math.sin(i * 0.3) * 5;
                const temp = baseTemp + Math.random() * 1.8 - 0.9;
                tempData.push(parseFloat(temp.toFixed(1)));
                
                // 湿度数据 (55-75之间波动)
                const humidity = 60 + Math.sin(i * 0.4) * 8 + Math.random() * 5 - 2.5;
                humidityData.push(parseInt(humidity));
                
                // 风速数据 (1.5-5之间波动)
                const wind = 2.5 + Math.sin(i * 0.5) * 1.5 + Math.random() * 0.8 - 0.4;
                windData.push(parseFloat(wind.toFixed(1)));
                
                // 理想负载 (基于温度模型)
                const ideal = 800 + (30 - temp) * 25 + Math.random() * 15;
                idealLoad.push(parseInt(ideal));
                
                // 实际负载 (理想负载加上一些波动)
                const actual = ideal * (0.92 + Math.random() * 0.05);
                actualLoad.push(parseInt(actual));
                
                // 效率计算 (基于温度和负载)
                const eff = 75 + (30 - temp) * 0.8 + (ideal - actual)/5 + Math.random() * 3;
                efficiency.push(parseFloat(Math.min(92, Math.max(70, eff)).toFixed(1)));
            }
            
            return { labels, tempData, humidityData, windData, idealLoad, actualLoad, efficiency };
        }
        
        // 更新卡片数据
        function updateCardData(data) {
            const lastIndex = data.tempData.length - 1;
            
            document.querySelector('.card:nth-child(1) .card-value').innerHTML = 
                data.tempData[lastIndex] + '<span>°C</span>';
            
            document.querySelector('.card:nth-child(2) .card-value').innerHTML = 
                data.humidityData[lastIndex] + '<span>%</span>';
            
            document.querySelector('.card:nth-child(3) .card-value').innerHTML = 
                data.windData[lastIndex] + '<span>m/s</span>';
            
            const efficiency = data.efficiency[lastIndex];
            document.querySelector('.card:nth-child(4) .card-value').innerHTML = 
                efficiency + '<span>%</span>';
            document.querySelector('.efficiency-fill').style.width = efficiency + '%';
        }
        
        // 更新图表
        function renderChart(data) {
            const ctx = document.getElementById('efficiency-chart').getContext('2d');
            
            if (window.efficiencyChart) {
                window.efficiencyChart.destroy();
            }
            
            window.efficiencyChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.labels,
                    datasets: [
                        {
                            label: '环境温度 (°C)',
                            data: data.tempData,
                            borderColor: '#FF9F40',
                            backgroundColor: 'rgba(255, 159, 64, 0.1)',
                            borderWidth: 3,
                            pointRadius: 0,
                            yAxisID: 'y1',
                            fill: true,
                            tension: 0.3
                        },
                        {
                            label: '相对湿度 (%)',
                            data: data.humidityData,
                            borderColor: '#36A2EB',
                            backgroundColor: 'transparent',
                            borderWidth: 2,
                            pointRadius: 0,
                            yAxisID: 'y2',
                            borderDash: [5, 5],
                            tension: 0.3
                        },
                        {
                            label: '理论最优负载 (kW)',
                            data: data.idealLoad,
                            borderColor: '#1abc9c',
                            borderWidth: 3,
                            pointRadius: 0,
                            yAxisID: 'y',
                            tension: 0.3
                        },
                        {
                            label: '实际负载 (kW)',
                            data: data.actualLoad,
                            borderColor: '#e74c3c',
                            backgroundColor: 'rgba(231, 76, 60, 0.1)',
                            borderWidth: 3,
                            pointRadius: 0,
                            fill: true,
                            yAxisID: 'y',
                            tension: 0.3
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                color: 'rgba(255, 255, 255, 0.85)',
                                font: {
                                    size: 13,
                                    weight: '500'
                                },
                                padding: 15,
                                usePointStyle: true,
                                pointStyle: 'circle'
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(30, 40, 60, 0.95)',
                            titleColor: '#1abc9c',
                            bodyColor: '#ecf0f1',
                            borderColor: 'rgba(255, 255, 255, 0.15)',
                            borderWidth: 1,
                            padding: 12,
                            cornerRadius: 8,
                            usePointStyle: true,
                            boxPadding: 6
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.07)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.6)',
                                maxRotation: 0,
                                maxTicksLimit: 12
                            }
                        },
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: '系统负载 (kW)',
                                color: 'rgba(255, 255, 255, 0.7)'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.07)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.6)'
                            },
                            min: 600,
                            max: 1100
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: '温度 (°C)',
                                color: 'rgba(255, 255, 255, 0.7)'
                            },
                            grid: {
                                drawOnChartArea: false
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.6)'
                            },
                            min: 18,
                            max: 32
                        },
                        y2: {
                            type: 'linear',
                            display: false,
                            position: 'right',
                            min: 40,
                            max: 80
                        }
                    }
                }
            });
        }
        
        // 更新时间显示
        function updateTime() {
            const now = new Date();
            const formattedTime = now.toLocaleString('zh-CN', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            document.getElementById('update-time').textContent = formattedTime;
        }
        
        // 处理时间范围按钮点击
        function setupTimeButtons() {
            const buttons = document.querySelectorAll('.time-btn');
            buttons.forEach(btn => {
                btn.addEventListener('click', function() {
                    buttons.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    // 在实际应用中，这里会重新获取对应时间范围的数据
                    // 现在只是模拟
                    const newData = generateData();
                    updateCardData(newData);
                    window.efficiencyChart.data.labels = newData.labels;
                    window.efficiencyChart.data.datasets[0].data = newData.tempData;
                    window.efficiencyChart.data.datasets[1].data = newData.humidityData;
                    window.efficiencyChart.data.datasets[2].data = newData.idealLoad;
                    window.efficiencyChart.data.datasets[3].data = newData.actualLoad;
                    window.efficiencyChart.update();
                    updateTime();
                });
            });
        }
        
        // 初始化
        function initDashboard() {
            const data = generateData();
            updateCardData(data);
            renderChart(data);
            updateTime();
            setupTimeButtons();
            
            // 每30秒更新数据
            setInterval(() => {
                const newData = generateData();
                updateCardData(newData);
                
                // 更新图表数据
                window.efficiencyChart.data.labels = newData.labels;
                window.efficiencyChart.data.datasets[0].data = newData.tempData;
                window.efficiencyChart.data.datasets[1].data = newData.humidityData;
                window.efficiencyChart.data.datasets[2].data = newData.idealLoad;
                window.efficiencyChart.data.datasets[3].data = newData.actualLoad;
                window.efficiencyChart.update();
                
                updateTime();
            }, 30000);
        }
        
        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', initDashboard);
    </script>
</body>
</html>